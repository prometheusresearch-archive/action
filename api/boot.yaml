entity:

  male:
    entity: individual
    where: sex = 'male'

  female:
    entity: individual
    where: sex = 'female'

workflow:

  start:
  - pickIndividual:
    - viewIndividual
    - siteForIndividual:
      - viewSite
    - ifMale:
      - viewMale

  pickIndividual:
    type: pick
    entity: individual
    fields: [id, code, sex]

  viewIndividual:
    type: view
    entity: individual
    fields: [id, code, sex]

  viewMale:
    type: view
    entity: individual
    fields: [id, code, sex]

  viewSite:
    type: view
    entity: site
    fields: [id, code, title]

  ifMale:
    type: guard
    require:
    - individual
    query:
      SELECT sex = 'male' as result FROM individual WHERE id = $individual

  siteForIndividual:
    type: query
    require:
    - individual
    query:
    - type: site
      query: select site_id as result FROM individual WHERE id = $individual
