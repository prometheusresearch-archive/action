entity:

  male:
    entity: individual
    where: sex = 'male'

  female:
    entity: individual
    where: sex = 'female'

workflow:

  start:
  - pick-individual:
    - view-individual
    - site-for-individual:
      - view-site
    - if-male:
      - view-male

  pick-individual:
    type: pick
    entity: individual
    fields: [id, code, sex]

  view-individual:
    type: view
    entity: individual
    fields: [id, code, sex]

  view-male:
    type: view
    entity: individual
    fields: [id, code, sex]

  view-site:
    type: view
    entity: site
    fields: [id, code, title]

  if-male:
    type: guard
    require:
    - individual
    query:
      SELECT sex = 'male' as result FROM individual WHERE id = $individual

  site-for-individual:
    type: query
    require:
    - individual
    query:
    - type: site
      query: select site_id as result FROM individual WHERE id = $individual
